<html>
<head>
<title>C</title>

<!-- latex math javascript-->
<script 
id="MathJax-script"
async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js">
</script>
<!-- open raw text -->
<script charset="utf-8">
function graph(name){
	var file = "src/" + name;
	window.open(file);
}
</script>

<link rel="stylesheet" type="text/css" href="https://ahsjlin.github.io/html_head/css/a/blue.css">
<link rel="stylesheet" type="text/css" href="https://ahsjlin.github.io/html_head/css/table/block.css">
<link rel="stylesheet" type="text/css" href="https://ahsjlin.github.io/html_head/css/code/code_color.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<style>
table.tmp_table tr {
	text-align: center;
}
table.tmp_table tr td {
	width: 70px;
}
</style>




</head>
<body>
標準的C語言main寫法:<br>
<p style="width: 30%;border: 1px solid black;" >
<embed src="./code/standard_main_c_code.html" type="">
</p>
<ol>
	<li> 回傳類型不建議用void，而用int。</li>
	<li>不建議用main()，而用main(void) 或 main(int argc, char *argv[])。</li>
	<li>回傳類型寫int，然後不寫return 0;還是可以編譯過，只有main限定，但還是寫出來比較好。</li>
</ol>
雖然上述不建議的地方，C語言還是可以編譯過，但是要和其他人協作，是需要規範標準規格，所以嚴格遵守寫作規則是相當重要的。C語言規格書: <a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf" target="_blank">C99</a> - <a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2310.pdf" target="_blank">C18</a>
<hr>
在 C 語言的物件就指在執行時期，資料儲存的區域，可以明確表示數值的內容
<hr>
linux kernel有許多地方是由C語言撰寫而成，kernel的編譯器會影響OS的效能。所以C語言除了熟悉語法外，演算法和debug能力是極其重要的。<a href="https://www.sourceware.org/gdb/" target="_blank">Debug工具: GDB</a>
<hr>
<h2>數值和字串的轉換</h2>
<p style="border: 1px solid black; width: 600;">
數值轉字串:
<embed src="./code/val2str.html" type="text/html" width="600" height="400">
snprintf第一個參數是被寫入的地方， 第二個是限制寫多長，第三是數值類型， 第四是數值變數。<br />
code裏有兩個sample, int和float的， 注意float的小數點位數記得設定。
</p>	
<p style="border: 1px solid black; width: 600;">
字串轉數值:
<embed src="./code/str2val.html" type="text/html" width="600" height="400">
	sscanf第一個參數放字串變數， 第二個放要轉成的類型， 第三個放要放入<span style="color: red">變數的記憶體位址</span>。<br />
code裏有四個sample， 前兩個爲int和混合string的， 後兩個爲float和混合string。
</p>	
<hr>
<h3>String</h3>
package: <pre><code class="co1">#include &ltstring.h&gt</code></pre>
<br/>
string length:<br/>
<pre><code class="co1">size_t strlen ( const char * str );</code></pre>
<br/>
It will return how many characters in string.(without '\0')
<br/>
(It takes one byte to hold one character.)
<br/>
If a string contain "I am fine."
<pre><code class="co1">#include &ltstdio.h&gt
#include &ltstring.h&gt
#define STR "I am fine."

int main(void) {

// strlen()
printf("%zd", strlen(STR));
// output 10

// sizeof
printf("%zd", sizeof STR);
// output 11 (contain '\0' means null character.)
</code></pre>

<hr>
<pre><code class="co1">sizeof</code></pre>
is an operator.
<hr>
<h3>printf</h3>
The "printf" will return number of characters.<br></br>
If sentence is too long. You can type '\' to split sentence.
<pre> <code>// example
printf("split \
first line.");
//output
split first line.</code> </pre>
<hr>
<h3>strncpy</h3>
<table>
		<tr>
	<td>
<embed src="./code/strncpy_sample.html" type="text/html" width="600" height="400">
	</td>
		</tr>
</table>
<hr>
<h3>gcc參數</h3>
ref<br>
<a href=https://www.runoob.com/w3cnote/gcc-parameter-detail.html"" target="_blank">gcc參數參考資料</a>
<hr>
<h3>gcc link dll</h3>
dllName: this_dll_sample.dll
<pre><code class="co1">gcc sample.c -lthis_dll_sample </code></pre>
<hr>
<h3>Displaying Octal and Hexadecimal</h3>
Write pound sign in center of percent sign and number notation.
<pre><code class="co1">// print octal and hexadecimal
printf("%#o, %#x\n", octal, hexadecimal);</code></pre>
<hr>
<h3>Integer Type</h3>
<pre><code class="co1">// "short int" or short
short int a_1;
// or
short a_2;

// "long int" or "long"
long int b_1;
// or 
long b_2

// "long long int" or "long long", at least 64-bit cpu.
long long int c_1;
// or
long long c_2;</code></pre>
<hr>
<h3>integer type</h3>
The "int32_t" is equal to "int".
<br>
The "uintmax_t" is bigger than "long long int" and "unsigned long".
<hr>
<h2>Floating-Point numbers</h2>
float, double, long double.
<br>
<h4>floating-point</h4>
<pre><code class="co1">printf("%f\n", -1.32e-11); </code></pre>
<hr>
<h2>Boolean Type</h2>
<pre><code class="co1">// example
_Bool b_1;

// C99, stdbool.h
bool b_2;</code></pre>
<hr>
<h2>sizeof</h2>
sizeof 搭配 %zd
<hr>
<h2>macro</h2>
<pre><code class="co1">#define MAX(a,b) ((a) > (b) ? (a) : (b)) </code></pre>
<pre><code class="co1">#ifndef SOME_H
#define SOME_H

/* Declare some data types and public functions. */

#endif</code></pre>
<pre><code class="co1">// 測測編譯環境
#if defined(_WIN32)
	#define PLATFORM "windows"
#elif defined(__linux__)
	#define PLATFORM "Linux"
#elif defined(__APPLE__)
	#define PLATFORM "mac"
#else
	#define PLATFORM "other os"
#endif
</code></pre>

<h2>一個#代表字串</h2>
#的內容要左右括號。(變數為字串)
<pre><code class="co1">#include &ltstdio.h&gt
 
#define pow(a) (#a)

int main(int argc, char *argv[]) {
	printf("%s\n", pow(sdkfjsdkf));
} </code></pre>
<h2>...和__VA_ARGS__</h2>
<pre><code class="co1">#define test(...) (printf("%d\n", __VA_ARGS__))

...

test(5000);
// output: 5000

</code></pre>
<h2>##可黏兩個變數</h2>
<pre><code class="co1">#define test(a,b) (printf("%d\n", a##b))

...

test(50,6);
// output: 506
</code></pre>


<h2>換行(反斜線)</h2>
<pre><code class="co1">#define test(5,6) ( \
printf("%d\n", a##b))</code></pre>

<h2>function sample</h2>
<pre><code class="co1">#define cmp(a,b,tmp)({ \
if((a)&gt(b)) { \
tmp = -1; \
} else if(((a)&lt(b))) { \
tmp = 1; \
} \
else { \
tmp = 0; \
} \
}) </code></pre>


<h2>pragma</h2>
說明define時的變數名稱可能撞名，可以在header的第一行加入#pragma once
<pre><code class="co1">#pragma once
#ifndef UTILS_H 
#define UTILS_H

/* ... */

#endif</code></pre>
<a href="https://opensourcedoc.com/c-programming/preprocessor/" target="_blank">參考</a>



<a href="https://opensourcedoc.com/c-programming/preprocessor/" target="_blank">更多巨集</a>
<hr>
<h2>assert</h2>
assert內容是True則不做任何事, Flase為顯示stderr，並停止。
<pre><code class="co1">#include &ltassert.h&gt

/* ...  */

int a;
scanf("%d", &a);
assert(a>10);
printf("a == %d", a);</code></pre>

<hr>
<h2>scanf</h2>
Pass parameter into the "*".<br>
*.*的第一個*是整個寬度(包含小數點位數), 第二個*為小數點後幾位。
<pre><code class="co1">int width, percision;
scanf("%d, %d", &width, &percision);
printf("%*.*f", width, percision, 3.2)</code></pre>
<h4>處理scanf("%d", var), var為非整數</h4>
<pre><code class="co1">int status;
int code;
while(status=scanf("%d", code)){
	if(status != 1)
		scanf("%*s"); // dispose non-integer
	printf("Enter an integer, please.\n");
}</code></pre>

<hr>
<h2>static</h2>
<ul>
	<li>static放區域變數前, 可保留變數之值，直到程式結束。</li>
	<li>static放全域變數前, 可防止其他c/cpp利用extern讀取。 </li>
	<li>static放函數前, 可防止其他c/cpp利用extern讀取。 </li>
</ul>
<a href="https://shengyu7697.github.io/cpp-static/" target="_blank">ShengYu Talk - C/C++ static 的 5 種用法</a>
<hr>
<h2>while搭配scanf輸入資料</h2>
<pre><code class="co1">#include &ltstdio.h&gt
#define FREEZING 4.0

int main(int argc, char *argv[]) {
	float temperature;
	int all_day = 0;
	int cold_day = 0;
	printf("Input temperature value. (any character to quit)\n");
	while(scanf("%f", &temperature)) {
		all_day++;
		if(temperature < FREEZING)
			cold_day++;
	}
	if(all_day==0)
		printf("No data!\n");
	else
		printf("%d cold day. Total of %d day(s).\n", cold_day, all_day);

	return 0;
}</code></pre>
<hr>
<h2>getchar() and putchar()</h2>
加密輸入值
<pre><code class="co1">#include &ltstdio.h&gt

int main(int argc, char *argv[]) {
	char ch;
	/* move characters. */
	/* getchar() be a statement. */
	/* while( (ch=getchar() ) != '\n'), don't need "ch = getchar()" in end. */
	/* The operator '!=' is higher priority than '='. Therefore, It need to bracket on "ch = getchar()". */
	ch = getchar();
	while(ch != '\n') {
		if(ch == ' ') {
			putchar(ch);
		} else {
			putchar(ch+1); // encryption
		}
		ch = getchar();
	}
	putchar(ch); // print the newline.
	return 0;
}</code></pre>
<hr>
<h2>ctype.h</h2>
提供判斷char類型的函數(ex. isalpha())
<br>
改寫上題
<pre><code class="co1">#include &ltstdio.h&gt
#include &ltctype.h&gt

int main(int argc, char *argv[]) {
	char ch;
	/* move characters. */
	while( (ch=getchar()) != '\n') {
		if(ch == isalpha()) {
			putchar(ch+1); // encryption
		} else {
			putchar(ch);
		}
	}
	putchar(ch); // print the newline.
	return 0;
}</code></pre>
<a href="https://cplusplus.com/reference/cctype/" target="_blank">cplusplus - cctype</a>
<hr>
<h2>conio.h</h2>
unbuffered input with getche().
<hr>
<h2>EOF</h2>
Control + Z
<pre><code class="co1">while( (ch=getchar()) != EOF); </code></pre>
<hr>
<h2>Pass pointer to function</h2>
ex. sum
<pre><code class="co1">#include &ltstdio.h&gt
#define SIZE 10
int total(int *start, int *end)
{
	int sum = 0;
	while(start < end) {
		sum += *start;
		start++;
	}
	return sum;
}
int main(int argc, char *argv[]) {
	int a[SIZE];
	int sum;
	for(int i=0; i&ltSIZE; i++)
		a[i] = 10;
	sum = total(a, a+SIZE);
	printf("%d\n", sum);
	return 0;
}


</code></pre>

<hr>
<h2>pointer and array</h2>
<pre><code class="co1">*(array_a + 2) == array_a[2];
*(*(array_b + 4) + 5) == array_b[4][5];
</code></pre>
<br>
<br>

<pre><code class="co1">int a[3][2] = {{1,2}, {3,4}, {5,6}};
	int (*p)[2]; // The 'p' is an address that point to two ints' address.
	/* Alternatively, p[][2] */
	p = a+1;
	printf("%d\n", (*p)[1]);
	/* output: 4 */
</code></pre>

<hr>
<h2>Variable-Length Arrays (VLAs)</h2>
<pre><code class="co1">#define COLS 4
int Sum(int ar[][COLS], int rows)
{
	int total = 0;

	for(int r=0; r&ltrows; r++)
		for(int c=0; c&ltCOLS; c++)
			total += ar[r][c];

	return total;
}
</code></pre>
假設要傳2維array, 其rows和columns也是傳送參數，則rows和columns要先傳(寫在左邊)
<pre><code class="co1">int Sum(int rows, int cols, int ar[rows][cols]); </code></pre>
C99/C11 可以捨棄變數名稱<br>
<pre><code class="co1">int Sum(int, int, int ar[*][*]); </code></pre>

<hr>
<h2>Compound Literals</h2>
<pre><code class="co1">int div[2] = {10, 20};
/* equal */
/* nameless */
(int [2]){10,20};

/* initialize */
(int []){50, 20, 100}; // a compound literal with 3 elements.

/* example */
int *pt1;
pt1 = (int [2]) {10, 20};


/* example */
/* pass parameters */
int sum(const int1r[], int n);

...

int total;
total = sum((int []{4, 2, 2, 4, 5}, 6);


/* example */
int (*pt)[4]; // int pt[][4] can not initialize.

pt = (int [2][4]){ {1,2,3,4}, {5,6,7,8} };
</code></pre>

<hr>
<h1 style="text-align: center;">Strings</h1>
<hr>
<pre><code class="co1">puts(); 

char str[] = "First" " Second" 
	" Third.";
/* Output: First Second Third.*/
</code></pre>
<br>
<br>
<a href="https://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm" target="_blank">fgets()</a><br>
<a href="https://www.tutorialspoint.com/c_standard_library/c_function_fputs.htm" target="_blank">fputs()</a><br>

<h4>putchar with pointer</h4>
<pre><code class="co1">#include &ltstdio.h&gt
void put1(const char *str)
{
	while(*str!='\0') // while(*str)
		putchar(*str++);
}
int main(int argc, char *argv[]) {
	put1("I want to fly!\n");
	return 0;

}


</code></pre>


<hr>
<h3>sprintf</h3>
write data into an address.
<pre><code class="co1">#include &ltstdio.h&gt
int main(int argc, char *argv[]) {
	char a1[40];
	int count;
	count = sprintf(a1, "Number is %d.", 10);
	puts(a1);
	printf("%d\n", count);
	return 0;

}


</code></pre>


<hr>
<h2>malloc</h2>
<pre><code class="co1">double *pt
pt = (double *) malloc(30 * sizeof(double));

...

free(pt);</code></pre>


<hr>
<h2>Volatile</h2>
只某個變數的值會隨時變化，如果沒有告訴compiler這個性質，它可能會最佳化結果(參考有詳細說明)，導致錯誤。
<br>
<a href="https://www.w3help.cc/a/202107/279361.html" target="_blank">reference - w3help</a>

<hr>
<h2>restrict</h2>
用來修飾pointer, 告訴compiler不能用其他變數去改這pointer的data。
<pre><code class="co1">int *restruct pt = (int*) malloc(10 sizeof(int));</code></pre>

<a href="https://liquid0118.pixnet.net/blog/post/48494846" target="_blank">Y CP的部落格</a>

<hr>
<h2>_Atomic</h2>
即設置的變數不能中途被訪問。
<a href="https://blog.csdn.net/Galaxy_Robot/article/details/106991200" target="_blank">CSDN - C语言的_Atomic类型限定符(C11)</a>

<hr>
<h1 style="text-align: center;">Files I/O</h1>
<hr>
<h2>fopen</h2>
<pre><code class="co1">#include &ltstdio.h&gt
#include &ltstdlib.h&gt

int main(int argc, char *argv[]) {
	int ch;
	FILE *fp;
	fp = fopen("SomeTextFile.txt", "r");
	while((ch=getc(fp)) != EOF)
		putc(ch, stdout); // putchar
	fclose(fp);

	return 0;
}

</code></pre>
<hr>
<h2>getc()</h2>
fp為FILE類型的指標, 功能是取得內容。
<pre><code class="co1">getc(fp); </code></pre>
<hr>
<h2>putc()</h2>
ch為要寫進的內容, fp為FILE類型的指標。
<pre><code class="co1">putc(ch, fp); </code></pre>

<hr>
<h2>rewind()</h2>
Go back to begining of file.
<pre><code class="co1">rewind(fp); </code></pre>


<hr>
<h2>fscanf()</h2>
參數: 第一個為file的指標, 第二個為類型, 第三個為所要放進內容的地方(要接受內容的變數)
<pre><code class="co1">#include &ltstdio.h&gt
#include &ltstdlib.h&gt

int main(int argc, char *argv[]) {
	int ch;
	char word[50];
	FILE *fp;
	fp = fopen("SomeTextFile.txt", "r");
	while(fscanf(fp, "%s", word)==1);
	fclose(fp);
	printf("%s", word);



	return 0;
}


</code></pre>

<hr>
<h2>fgets()</h2>
限制從file取得的長度
<pre><code class="co1">#include &ltstdio.h&gt
#include &ltstdlib.h&gt

int main(int argc, char *argv[]) {
	int ch;
	char word[50];
	FILE *fp;
	fp = fopen("SomeTextFile.txt", "r");
	fgets(word, 7, fp);
	fclose(fp);
	printf("%s", word);

	return 0;
}

</code></pre>
<hr>
<h2>fputs()</h2>
參數: 第一個為char的array指標變數, 第二個為FILE類型的指標。
<pre><code class="co1">fputs(word, fp); </code></pre>

<hr>
<h2>Pointers to Strutures</h2>
<pre><code class="co1">#include &ltstdio.h&gt
 
struct book {
	char linear_algebra[50];
	char Discrete[50];
};

int main(int argc, char *argv[]) {
	struct book bookcase[2] = {
		{"book_a", "book_b"},
		{"book_c", "book_d"}
	};
	struct book *pt;

	pt = bookcase;

	puts(pt->linear_algebra);
	// output: book_a
	
	pt++; // point to next index.
	puts(pt->linear_algebra);
	// output: book_c

	return 0;
}

</code></pre>


<hr>
<h2>fwrite()</h2>
參數: 第一個為字串的指標, 第二個為寫入類型大小, 第三個為要寫入多少進去, 第四個為寫進FILE類型的指標。
<pre><code class="co1">fwrite(&primer, sizeof(struct book), 1, fp); </code></pre>

<a href="https://www.796t.com/content/1547098574.html" target="_blank">ref - 程式人生</a> <br>
<a href="http://c.biancheng.net/view/2071.html#:~:text=ptr%20%E4%B8%BA%E5%86%85%E5%AD%98%E5%8C%BA%E5%9D%97,%E6%95%B0%E6%8D%AE%E5%9D%97%E7%9A%84%E5%9D%97%E6%95%B0%E3%80%82" target="_blank">ref - C語言中文網</a> <br>

<hr>
<h2>enum</h2>
<pre><code class="co1">enum DAY {
	MON=1,
	TUE,
	WED,
	THU,
	FRI,
	SAT,
	SUN
};
int main(void)
{
	enum DAY day_var;
	day_var = WED;

	printf("%d\n", day_var);
	// output: 3


	return 0;
}</code></pre>

<a href="https://www.runoob.com/cprogramming/c-enum.html" target="_blank">ref - runoob</a>


<hr>
<h2>calloc</h2>
需要stdlib.h<br>
calloc和malloc相似，但calloc會初始化內容為都為0。calloc輸入為2個參數。
<hr>
<h2>realloc</h2>
重新分配大小
<pre><code class="co1">
int *returnArr = (int *)malloc(100*sizeof(int));
int *size = 10;
returnArr = realloc(returnArr, (*size)*sizeof(int));

</code></pre>

<hr>
<h2>Hash Table</h2>
<pre><code class="co1">int t['z'+1] = {
	['a'] = 10,
	['c'] = 30,
	['d'] = 40,
};
printf("%d\n", t['f']); // t['f'] == 0
printf("%d\n", t['d']); // t['d'] == 40
</code></pre>
<a href="https://leetcode.com/problems/roman-to-integer/discuss/2373950/1LINERFastest-Solution-Explained-O(n)time-complexity-O(n)space-complexity" target="_blank">cucerdariancatalin - [1LINER][Fastest Solution Explained] O(n)time complexity O(n)space complexity</a>


<hr>
<h2>Print binary bit</h2>
<pre><code class="co1">
int a= 10
for(int n=31; n&gt=0; n--) {
	printf("%d", a&gt&gtn & 1);
}
</code></pre>
<hr>
<h2>Bit Mask</h2>
<pre><code class="co1">


int n = 10;
// set the 5th bit from right to 1
int mask = 1&lt&lt4;
n |= mask;

// set the 3rd bit from right to 0
int mask = ~(1&lt&lt2);
n &= mask;

// toggle the 4rd bit from right
int mask = 1&lt&lt3;
n ^= mask;
</code></pre>
<hr>
<h2>conio.h</h2>
get char without display
<pre><code class="co1">getch() </code></pre>
display version
<pre><code class="co1">getche() </code></pre>

<hr>
set cursor position
<pre><code class="co1">
    // COORD pos = { 10,5 };
    COORD pos;
    pos.X = (short)5;
    pos.Y = (short)3;
    HANDLE hOut = GetStdHandle(STD_OUTPUT_HANDLE);
 
    SetConsoleCursorPosition(hOut, pos);
 
 	/* set text color */
    SetConsoleTextAttribute(hOut, 0x01 | 0x05);
 
    printf("Something Something");
</code></pre>

<hr>
<h2>typedef</h2>
<a href="https://blog.xuite.net/jesonchung/scienceview/93554949" target="_blank">reference</a>
<hr>
<h2>function pointer</h2>
<a href="https://stackoverflow.com/questions/4295432/typedef-function-pointer" target="_blank">reference</a>
<hr>
<h2>Pointer</h2>
<a href="https://hackmd.io/@sysprog/c-pointer" target="_blank">pointer</a>






<hr>
<footer>
<h2>Reference</h2>
<a href="https://hackmd.io/@sysprog/c-standards" target="_blank">你所不知道的 C 語言: 開發工具和規格標準</a><br>

</footer>

</body>
</html>
